import pandas as pd
import psycopg2

def readIntVuln(connstr,vulnid):
    filedir=connstr+'VulnValues.csv'
    try: 
        vulntable=pd.read_csv(filedir)
    except :
        print("unable to create connection")
    vulntable=vulntable[vulntable.vulnID_fk_id==vulnid]
    vulntable['mean_x'] =vulntable.apply(lambda row: (row.hazIntensity_from+row.hazIntensity_to)/2, axis=1)
    assert not vulntable.empty , f"The vulnerability table for id {vulnid} do not exists"
    return vulntable

def readSusVuln(connstr,vulnid):
    filedir=connstr+'VulnValues.csv'
    try: 
        vulntable=pd.read_csv(filedir)
    except :
        print("unable to create connection")
    vulntable=vulntable[vulntable.vulnID_fk_id==vulnid]
    vulntable=vulntable.rename(columns={"hazIntensity_from": "mean_x"})
    assert not vulntable.empty , f"The vulnerability table for id {vulnid} do not exists"
    return vulntable

